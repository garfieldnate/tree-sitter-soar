================================================================================
strings
================================================================================

sp {strings
    (state <s> ^foo { a b })
-->    (<s> ^foo bar)
}

--------------------------------------------------------------------------------

(source_file
  (production
    (beginning
      (prod_name))
    (cond
      (positiveCond
        (condsForOneId
          (condType)
          (idTest
            (test
              (simpleTest
                (singleTest
                  (variable)))))
          (attrValueTests
            (attrTest
              (test
                (simpleTest
                  (singleTest
                    (string)))))
            (valueTest
              (test
                (conjunctiveTest
                  (simpleTest
                    (singleTest
                      (string)))
                  (simpleTest
                    (singleTest
                      (string))))))))))
    (variableMutation
      (variable)
      (attrValueMake
        (string)
        (valueMake
          (string))))))

================================================================================
strings no space
================================================================================

sp {strings-spaceless
    (state <s> ^foo {a b})
-->    (<s> ^foo bar)
}

--------------------------------------------------------------------------------

(source_file
  (production
    (beginning
      (prod_name))
    (cond
      (positiveCond
        (condsForOneId
          (condType)
          (idTest
            (test
              (simpleTest
                (singleTest
                  (variable)))))
          (attrValueTests
            (attrTest
              (test
                (simpleTest
                  (singleTest
                    (string)))))
            (valueTest
              (test
                (conjunctiveTest
                  (simpleTest
                    (singleTest
                      (string)))
                  (simpleTest
                    (singleTest
                      (string))))))))))
    (variableMutation
      (variable)
      (attrValueMake
        (string)
        (valueMake
          (string))))))

================================================================================
quotes
================================================================================

sp {quoted
    (state <s> ^foo { |a| |\|b| |c| })
-->    (<s> ^foo bar)
}

--------------------------------------------------------------------------------

(source_file
  (production
    (beginning
      (prod_name))
    (cond
      (positiveCond
        (condsForOneId
          (condType)
          (idTest
            (test
              (simpleTest
                (singleTest
                  (variable)))))
          (attrValueTests
            (attrTest
              (test
                (simpleTest
                  (singleTest
                    (string)))))
            (valueTest
              (test
                (conjunctiveTest
                  (simpleTest
                    (singleTest
                      (quoted)))
                  (simpleTest
                    (singleTest
                      (quoted)))
                  (simpleTest
                    (singleTest
                      (quoted))))))))))
    (variableMutation
      (variable)
      (attrValueMake
        (string)
        (valueMake
          (string))))))

================================================================================
disjunct
================================================================================

sp {disjunct
    (state <s> ^foo { << a b c >> << t u >> })
-->    (<s> ^foo bar)
}

--------------------------------------------------------------------------------

(source_file
  (production
    (beginning
      (prod_name))
    (cond
      (positiveCond
        (condsForOneId
          (condType)
          (idTest
            (test
              (simpleTest
                (singleTest
                  (variable)))))
          (attrValueTests
            (attrTest
              (test
                (simpleTest
                  (singleTest
                    (string)))))
            (valueTest
              (test
                (conjunctiveTest
                  (simpleTest
                    (disjunctionTest
                      (string)
                      (string)
                      (string)))
                  (simpleTest
                    (disjunctionTest
                      (string)
                      (string))))))))))
    (variableMutation
      (variable)
      (attrValueMake
        (string)
        (valueMake
          (string))))))

================================================================================
variable
================================================================================

sp {variable
    (state <s> ^foo { <bar> baz })
-->    (<s> ^foo bar)
}

--------------------------------------------------------------------------------

(source_file
  (production
    (beginning
      (prod_name))
    (cond
      (positiveCond
        (condsForOneId
          (condType)
          (idTest
            (test
              (simpleTest
                (singleTest
                  (variable)))))
          (attrValueTests
            (attrTest
              (test
                (simpleTest
                  (singleTest
                    (string)))))
            (valueTest
              (test
                (conjunctiveTest
                  (simpleTest
                    (singleTest
                      (variable)))
                  (simpleTest
                    (singleTest
                      (string))))))))))
    (variableMutation
      (variable)
      (attrValueMake
        (string)
        (valueMake
          (string))))))

================================================================================
should fail without closing brace
================================================================================

sp {no-ending
    (state <s> ^foo {a b)
-->    (<s> ^foo bar)
}

--------------------------------------------------------------------------------

(source_file
  (production
    (beginning
      (prod_name))
    (cond
      (positiveCond
        (condsForOneId
          (condType)
          (idTest
            (test
              (simpleTest
                (singleTest
                  (variable)))))
          (attrValueTests
            (attrTest
              (test
                (simpleTest
                  (singleTest
                    (string)))))
            (valueTest
              (test
                (conjunctiveTest
                  (simpleTest
                    (singleTest
                      (string)))
                  (simpleTest
                    (singleTest
                      (string)))
                  (MISSING "}"))))))))
    (variableMutation
      (variable)
      (attrValueMake
        (string)
        (valueMake
          (string))))))

================================================================================
should fail without opening brace
================================================================================

sp {no-ending
    (state <s> ^foo a b})
-->    (<s> ^foo bar)
}

--------------------------------------------------------------------------------

(source_file
  (production
    (beginning
      (prod_name))
    (cond
      (positiveCond
        (condsForOneId
          (condType)
          (idTest
            (test
              (simpleTest
                (singleTest
                  (variable)))))
          (attrValueTests
            (attrTest
              (test
                (simpleTest
                  (singleTest
                    (string)))))
            (valueTest
              (test
                (simpleTest
                  (singleTest
                    (string)))))
            (valueTest
              (test
                (simpleTest
                  (singleTest
                    (string))))))
          (ERROR))))
    (variableMutation
      (variable)
      (attrValueMake
        (string)
        (valueMake
          (string))))))

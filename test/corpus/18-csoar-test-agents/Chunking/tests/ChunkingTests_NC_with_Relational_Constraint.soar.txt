================================================================================
UnitTests/SoarTestAgents/Chunking/tests/ChunkingTests_NC_with_Relational_Constraint.soar
================================================================================

# Negative conditions

srand 23
chunk always

sp {init-superstate
    (state <s> ^superstate nil)
-->
    (<s> ^test-item 9 7 6
         ^test-item2 9 7
         ^test-param <tp> <tp2> <tp3>
         ^test-param2 <tp3>
         ^test-current 1
         ^bar blue
         ^test-id <ti>)
    (<tp3> ^foo <tp> ^foo <tp2>)
    (<tp> ^value 9 8)
    (<tp2> ^value <dummy1> <dummy2>)
    (write (crlf) |Starting chunking unit test.|)
}

sp {propose*top
    (state <s> ^superstate nil)
-->
    (<s> ^operator <o>)
    (<o> ^name do-test)
}

sp {apply*test-done
    (state <s> ^superstate nil ^test-done)
-->
    (write (crlf) |Chunk produced. Test completed.|)
    (succeeded)
    (interrupt)
}

sp {apply*test-failed
    (state <s> ^superstate.superstate.superstate.superstate nil)
-->
    (write (crlf) |Chunk not produced.  Test failed.|)
    (interrupt)
}

sp {init-substate
    (state <s> ^superstate.superstate nil)
-->
    (<s> ^name substate)}

sp {propose*test
    (state <s> ^name substate)
-->
    (<s> ^operator <o> +)
    (<o> ^name test)}

sp {apply21b
    (state <s> ^operator <o>
               ^superstate <ss>)
    (<ss> ^test-item { > <y> <x> }
          ^test-item <y>
         -^foo { > <x> }
          ^test-current 1)
-->
    (<ss> ^result <y> ^test-done 1)
}

#run
#ctf expected/chunk21.soar print -cf
--------------------------------------------------------------------------------

(source_file
  (ERROR
    (UNEXPECTED 'r')
    (intConstant)
    (UNEXPECTED 'a'))
  (production
    (beginning
      (prod_name))
    (LHS
      (cond
        (positiveCond
          (condsForOneId
            (condType)
            (idTest
              (test
                (simpleTest
                  (singleTest
                    (variable)))))
            (attrValueTests
              (attrTest
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string)))))))
              (valueTest
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string))))))))))))
    (action
      (variable)
      (attrValueMake
        (rhsValue
          (constant
            (symConstant
              (string))))
        (valueMake
          (rhsValue
            (constant
              (intConstant))))
        (valueMake
          (rhsValue
            (constant
              (intConstant))))
        (valueMake
          (rhsValue
            (constant
              (intConstant)))))
      (attrValueMake
        (rhsValue
          (constant
            (symConstant
              (string))))
        (valueMake
          (rhsValue
            (constant
              (intConstant))))
        (valueMake
          (rhsValue
            (constant
              (intConstant)))))
      (attrValueMake
        (rhsValue
          (constant
            (symConstant
              (string))))
        (valueMake
          (rhsValue
            (variable)))
        (valueMake
          (rhsValue
            (variable)))
        (valueMake
          (rhsValue
            (variable))))
      (attrValueMake
        (rhsValue
          (constant
            (symConstant
              (string))))
        (valueMake
          (rhsValue
            (variable))))
      (attrValueMake
        (rhsValue
          (constant
            (symConstant
              (string))))
        (valueMake
          (rhsValue
            (constant
              (intConstant)))))
      (attrValueMake
        (rhsValue
          (constant
            (symConstant
              (string))))
        (valueMake
          (rhsValue
            (constant
              (symConstant
                (string))))))
      (attrValueMake
        (rhsValue
          (constant
            (symConstant
              (string))))
        (valueMake
          (rhsValue
            (variable)))))
    (action
      (variable)
      (attrValueMake
        (rhsValue
          (constant
            (symConstant
              (string))))
        (valueMake
          (rhsValue
            (variable))))
      (attrValueMake
        (rhsValue
          (constant
            (symConstant
              (string))))
        (valueMake
          (rhsValue
            (variable)))))
    (action
      (variable)
      (attrValueMake
        (rhsValue
          (constant
            (symConstant
              (string))))
        (valueMake
          (rhsValue
            (constant
              (intConstant))))
        (valueMake
          (rhsValue
            (constant
              (intConstant))))))
    (action
      (variable)
      (attrValueMake
        (rhsValue
          (constant
            (symConstant
              (string))))
        (valueMake
          (rhsValue
            (variable)))
        (valueMake
          (rhsValue
            (variable)))))
    (action
      (funcCall
        (funcName
          (symConstant
            (string)))
        (rhsValue)
        (rhsValue
          (constant
            (symConstant
              (quoted)))))))
  (production
    (beginning
      (prod_name))
    (LHS
      (cond
        (positiveCond
          (condsForOneId
            (condType)
            (idTest
              (test
                (simpleTest
                  (singleTest
                    (variable)))))
            (attrValueTests
              (attrTest
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string)))))))
              (valueTest
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string))))))))))))
    (action
      (variable)
      (attrValueMake
        (rhsValue
          (constant
            (symConstant
              (string))))
        (valueMake
          (rhsValue
            (variable)))))
    (action
      (variable)
      (attrValueMake
        (rhsValue
          (constant
            (symConstant
              (string))))
        (valueMake
          (rhsValue
            (constant
              (symConstant
                (string))))))))
  (production
    (beginning
      (prod_name))
    (LHS
      (cond
        (positiveCond
          (condsForOneId
            (condType)
            (idTest
              (test
                (simpleTest
                  (singleTest
                    (variable)))))
            (attrValueTests
              (attrTest
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string)))))))
              (valueTest
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string))))))))
            (attrValueTests
              (attrTest
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string))))))))))))
    (action
      (funcCall
        (funcName
          (symConstant
            (string)))
        (rhsValue)
        (rhsValue
          (constant
            (symConstant
              (quoted))))))
    (action
      (funcCall
        (funcName
          (symConstant
            (string)))))
    (action
      (funcCall
        (funcName
          (symConstant
            (string))))))
  (production
    (beginning
      (prod_name))
    (LHS
      (cond
        (positiveCond
          (condsForOneId
            (condType)
            (idTest
              (test
                (simpleTest
                  (singleTest
                    (variable)))))
            (attrValueTests
              (attrTest
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string))))))
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string))))))
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string))))))
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string)))))))
              (valueTest
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string))))))))))))
    (action
      (funcCall
        (funcName
          (symConstant
            (string)))
        (rhsValue)
        (rhsValue
          (constant
            (symConstant
              (quoted))))))
    (action
      (funcCall
        (funcName
          (symConstant
            (string))))))
  (production
    (beginning
      (prod_name))
    (LHS
      (cond
        (positiveCond
          (condsForOneId
            (condType)
            (idTest
              (test
                (simpleTest
                  (singleTest
                    (variable)))))
            (attrValueTests
              (attrTest
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string))))))
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string)))))))
              (valueTest
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string))))))))))))
    (action
      (variable)
      (attrValueMake
        (rhsValue
          (constant
            (symConstant
              (string))))
        (valueMake
          (rhsValue
            (constant
              (symConstant
                (string))))))))
  (production
    (beginning
      (prod_name))
    (LHS
      (cond
        (positiveCond
          (condsForOneId
            (condType)
            (idTest
              (test
                (simpleTest
                  (singleTest
                    (variable)))))
            (attrValueTests
              (attrTest
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string)))))))
              (valueTest
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string))))))))))))
    (action
      (variable)
      (attrValueMake
        (rhsValue
          (constant
            (symConstant
              (string))))
        (valueMake
          (rhsValue
            (variable))
          (preferenceSpecifier
            (unaryPreference)))))
    (action
      (variable)
      (attrValueMake
        (rhsValue
          (constant
            (symConstant
              (string))))
        (valueMake
          (rhsValue
            (constant
              (symConstant
                (string))))))))
  (production
    (beginning
      (prod_name))
    (LHS
      (cond
        (positiveCond
          (condsForOneId
            (condType)
            (idTest
              (test
                (simpleTest
                  (singleTest
                    (variable)))))
            (attrValueTests
              (attrTest
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string)))))))
              (valueTest
                (test
                  (simpleTest
                    (singleTest
                      (variable))))))
            (attrValueTests
              (attrTest
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string)))))))
              (valueTest
                (test
                  (simpleTest
                    (singleTest
                      (variable)))))))))
      (cond
        (positiveCond
          (condsForOneId
            (idTest
              (test
                (simpleTest
                  (singleTest
                    (variable)))))
            (attrValueTests
              (attrTest
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string)))))))
              (valueTest
                (test
                  (conjunctiveTest
                    (simpleTest
                      (relationalTest
                        (relation)
                        (singleTest
                          (variable))))
                    (simpleTest
                      (singleTest
                        (variable)))))))
            (attrValueTests
              (attrTest
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string)))))))
              (valueTest
                (test
                  (simpleTest
                    (singleTest
                      (variable))))))
            (attrValueTests
              (attrTest
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string)))))))
              (valueTest
                (test
                  (conjunctiveTest
                    (simpleTest
                      (relationalTest
                        (relation)
                        (singleTest
                          (variable))))))))
            (attrValueTests
              (attrTest
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (symConstant
                          (string)))))))
              (valueTest
                (test
                  (simpleTest
                    (singleTest
                      (constant
                        (intConstant)))))))))))
    (action
      (variable)
      (attrValueMake
        (rhsValue
          (constant
            (symConstant
              (string))))
        (valueMake
          (rhsValue
            (variable))))
      (attrValueMake
        (rhsValue
          (constant
            (symConstant
              (string))))
        (valueMake
          (rhsValue
            (constant
              (intConstant))))))))

================================================================================
UnitTests/SoarTestAgents/smem/SMemFunctionalTests_testMaxMultivalued.soar
================================================================================

smem --set learning on

#Dump some records into smem
smem --add {
  (<x> ^name val
  	   ^value 1
  	   ^value 4)
}
smem --add {
  (<x> ^name val
  	   ^value 5
	   ^value -2)
}
smem --add {
  (<x> ^name val
  	   ^value 2)
  	   ^value 3)
}
smem --add {
  (<x> ^name val
  	   ^value 4
  	   ^value 4)
}
smem --add {
  (<x> ^name val
  	   ^value 3
  	   ^value monkey)
}

#Test the max query
sp {propose*query
  (state <s> ^superstate nil 
             ^smem <smem>)
  (<smem> -^result.retrieved)
--> 
  (<s> ^operator.name query)
}

sp {apply*query
  (state <s> ^operator.name query
             ^smem.command <sc>)
-->
  (<sc> ^query.name |val|)
  (<sc> ^math-query.value.max <x>)
}

sp {success
  (state <s> ^smem.result.retrieved <lti>)
  (<lti> ^name val
         ^value 5
         ^value -2)
-->
  (succeeded)
}
--------------------------------------------------------------------------------

(source_file
  (ERROR
    (UNEXPECTED 'm')
    (UNEXPECTED 'e')
    (UNEXPECTED 'm')
    (UNEXPECTED 'a')
    (variable)
    (UNEXPECTED 'n')
    (UNEXPECTED 'v')
    (intConstant)
    (UNEXPECTED 'v')
    (intConstant)
    (UNEXPECTED 'm')
    (UNEXPECTED 'a')
    (variable)
    (UNEXPECTED 'n')
    (UNEXPECTED 'v')
    (intConstant)
    (UNEXPECTED 'v')
    (intConstant)
    (UNEXPECTED 'm')
    (UNEXPECTED 'a')
    (variable)
    (UNEXPECTED 'n')
    (UNEXPECTED 'v')
    (intConstant)
    (UNEXPECTED 'v')
    (intConstant)
    (UNEXPECTED 'm')
    (UNEXPECTED 'a')
    (variable)
    (UNEXPECTED 'n')
    (UNEXPECTED 'v')
    (intConstant)
    (UNEXPECTED 'v')
    (intConstant)
    (UNEXPECTED 'm')
    (UNEXPECTED 'a')
    (variable)
    (UNEXPECTED 'n')
    (UNEXPECTED 'v')
    (intConstant)
    (UNEXPECTED 'v'))
  (production
    (beginning
      (prod_name))
    (cond
      (positiveCond
        (condsForOneId
          (condType)
          (idTest
            (test
              (simpleTest
                (singleTest
                  (variable)))))
          (attrValueTests
            (attrTest
              (test
                (simpleTest
                  (singleTest
                    (string)))))
            (valueTest
              (test
                (simpleTest
                  (singleTest
                    (string))))))
          (attrValueTests
            (attrTest
              (test
                (simpleTest
                  (singleTest
                    (string)))))
            (valueTest
              (test
                (simpleTest
                  (singleTest
                    (variable)))))))))
    (cond
      (positiveCond
        (condsForOneId
          (idTest
            (test
              (simpleTest
                (singleTest
                  (variable)))))
          (attrValueTests
            (attrTest
              (test
                (simpleTest
                  (singleTest
                    (string))))
              (test
                (simpleTest
                  (singleTest
                    (string)))))))))
    (variableMutation
      (variable)
      (attrValueMake
        (string)
        (valueMake
          (floatConstant))
        (valueMake
          (string))
        (valueMake
          (string)))))
  (production
    (beginning
      (prod_name))
    (cond
      (positiveCond
        (condsForOneId
          (condType)
          (idTest
            (test
              (simpleTest
                (singleTest
                  (variable)))))
          (attrValueTests
            (attrTest
              (test
                (simpleTest
                  (singleTest
                    (string))))
              (test
                (simpleTest
                  (singleTest
                    (string)))))
            (valueTest
              (test
                (simpleTest
                  (singleTest
                    (string))))))
          (attrValueTests
            (attrTest
              (test
                (simpleTest
                  (singleTest
                    (string))))
              (test
                (simpleTest
                  (singleTest
                    (string)))))
            (valueTest
              (test
                (simpleTest
                  (singleTest
                    (variable)))))))))
    (variableMutation
      (variable)
      (attrValueMake
        (string)
        (valueMake
          (floatConstant))
        (valueMake
          (string))
        (valueMake
          (quoted))))
    (variableMutation
      (variable)
      (attrValueMake
        (string)
        (valueMake
          (floatConstant))
        (valueMake
          (string))
        (valueMake
          (floatConstant))
        (valueMake
          (string))
        (valueMake
          (variable)))))
  (production
    (beginning
      (prod_name))
    (cond
      (positiveCond
        (condsForOneId
          (condType)
          (idTest
            (test
              (simpleTest
                (singleTest
                  (variable)))))
          (attrValueTests
            (attrTest
              (test
                (simpleTest
                  (singleTest
                    (string))))
              (test
                (simpleTest
                  (singleTest
                    (string))))
              (test
                (simpleTest
                  (singleTest
                    (string)))))
            (valueTest
              (test
                (simpleTest
                  (singleTest
                    (variable)))))))))
    (cond
      (positiveCond
        (condsForOneId
          (idTest
            (test
              (simpleTest
                (singleTest
                  (variable)))))
          (attrValueTests
            (attrTest
              (test
                (simpleTest
                  (singleTest
                    (string)))))
            (valueTest
              (test
                (simpleTest
                  (singleTest
                    (string))))))
          (attrValueTests
            (attrTest
              (test
                (simpleTest
                  (singleTest
                    (string)))))
            (valueTest
              (test
                (simpleTest
                  (singleTest
                    (string))))))
          (attrValueTests
            (attrTest
              (test
                (simpleTest
                  (singleTest
                    (string)))))
            (valueTest
              (test
                (simpleTest
                  (singleTest
                    (string)))))))))
    (funcCall
      (funcName
        (string)))))
